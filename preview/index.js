async function c(n){return location.href=n,await h()}function h(){let n=t=>{setTimeout(()=>n(t),400)};return new Promise(n)}var a=class{element;contents;constructor(t){this.element=s(`${t}/error`,HTMLElement),this.contents=s(`${t}/error/content`,HTMLElement)}clearError(){this.element.classList.add("collapse"),this.element.ariaHidden="true",this.contents.textContent=""}addError(t){if(this.contents.textContent===""){this.setError(`Invalid form: ${t}`);return}this.contents.textContent+=`, ${t}`}setError(t){this.element.classList.remove("collapse"),this.element.ariaHidden="false",this.contents.textContent=t}unexpectedResponse(t){this.setError(`Could not ${t} because the server sent an unexpected response.`)}},u=class{input;error;constructor(t,e){this.input=s(`${t}${e}/input`,HTMLInputElement),this.error=s(`${t}${e}/error`,HTMLElement),this.input.addEventListener("input",()=>{this.input.setCustomValidity("")})}getValue(){return this.input.type==="checkbox"?this.input.checked?"checked":"unchecked":this.input.value}lock(){this.input.disabled=!0}unlock(){this.input.disabled=!1}clearError(){this.input.setCustomValidity(""),this.error.classList.add("hidden"),this.error.ariaHidden="true",this.error.textContent="!"}addError(t){if(this.error.textContent==="!"){this.setError(`Invalid value: ${t}`);return}this.error.textContent+=`, ${t}`,this.input.setCustomValidity(this.error.textContent??"Invalid value")}setError(t){this.input.setCustomValidity(t),this.error.classList.remove("hidden"),this.error.ariaHidden="false",this.error.textContent=t}},l=class{form;formError;submitButton;inputs;constructor(t,e){this.form=s(t,HTMLFormElement),this.formError=new a(t),this.submitButton=s(`${t}/submit`,HTMLButtonElement);let r=new Map;for(let o of e)r.set(o,new u(t,o));this.inputs=r}clearErrors(){this.formError.clearError();for(let t of this.inputs.values())t.clearError()}lock(){this.submitButton.disabled=!0;for(let t of this.inputs.values())t.lock()}unlock(){this.submitButton.disabled=!1;for(let t of this.inputs.values())t.unlock()}setInputErrors(t){if(!t||t.length===0){this.formError.addError("an unknown field is invalid");return}for(let e of t){let r=null;e.pointer&&(r=this.inputs.get(e.pointer)??null),r&&e.detail?r.addError(e.detail):r&&!e.detail?r.addError("unknown reason"):!r&&e.detail?this.formError.addError(e.detail):this.formError.addError("an unknown field is invalid")}}getValues(){let t=new Map;for(let[e,r]of this.inputs)t.set(e,r.getValue());return t}};function s(n,t){let e=document.getElementById(n);if(!e||!(e instanceof t))throw`element '${n}' does not exist`;return e}var i=new l("/register",["/username","/displayName"]);i.form.addEventListener("submit",n=>{n.preventDefault(),i.lock(),i.clearErrors();let t=i.getValues(),e=t.get("/username")??"",r=t.get("/displayName")??"";console.log(e),console.log(r),setTimeout(function(){let o=[{pointer:"/username",detail:"too long"},{pointer:"/displayName",detail:"too short"},{pointer:"/displayName",detail:"contains illegal character"},{pointer:"/authorization",detail:"unauthorized"},{pointer:null,detail:"internal server error"},{pointer:"/username",detail:null},{pointer:null,detail:null},{pointer:null,detail:null}];i.setInputErrors(o),i.unlock()},1e3)});var d=document.getElementById("redirect");d&&d.addEventListener("click",async()=>{await c("/source"),console.log("Shouldn't execute")});
//# sourceMappingURL=index.js.map
