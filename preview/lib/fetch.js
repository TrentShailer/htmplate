// deno-lint-ignore-file
// deno-fmt-ignore-file
// @ts-nocheck
// @ts-self-types="./fetch.d.ts
async function fetch(method,url,additionalHeaders,body){var a=new Headers;if(additionalHeaders)for(var e of additionalHeaders)a.append(e[0],e[1]);body&&a.append("content-type","application/json");additionalHeaders=localStorage.getItem("token");additionalHeaders&&a.append("Authorization",additionalHeaders);let t=null;body&&(t=JSON.stringify(body));additionalHeaders=await self.fetch(url,{method:method,body:t,headers:a}).catch(()=>new Response(null,{status:500}));if(additionalHeaders.ok)return(body=additionalHeaders.headers.get("Authorization"))&&localStorage.setItem("token",body),{status:"ok",body:await additionalHeaders.json()};if(401===additionalHeaders.status)return{status:"unauthorized"};if(400<=additionalHeaders.status&&additionalHeaders.status<500){let a=await additionalHeaders.json();return{status:"clientError",problems:a.problems??[]}}return{status:"serverError"}}export{fetch};